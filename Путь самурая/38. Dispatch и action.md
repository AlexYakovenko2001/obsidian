[[Samurai way]]
### Dispatch и action
**Theory:**
Так как все данные у нас будут храниться в одном объекте *store*, а количество функций, которые работают с данными будет постепенно увеличиваться, то в какой-то момент пользоваться приложением станет затруднительно. Поэтому будем вводить вместо десятков или сотен методов один метод под названием *dispatch*.
**Actions:**
1. Добавляем в объект *store* новый метод, назовём его *dispatch*. Теперь тот, кто во внешнем мире захочет пользоваться каким-то методом, изменяющим стейт, будет вызывать один единственный метод *dispatch*, вместо вызова каждого метода по отдельности.
2. Добавляем этому методу в качестве параметра *action*. Action - это всегда объект. Для чего он нужен нашему методу? Скоро мы начнём переносить все те методы, которые сейчас есть в объекте *store*, внутрь метода *dispatch*, и для того, чтобы диспатч понимал какую именно функцию ему нужно сейчас вызвать, в параметрах мы будем передавать *action* - своего рода инструкцию по тому, что именно должно произойти.
3. Теперь пишем логику для метода *dispatch*, не буду расписывать как это делается. Это типичный редьюсер, про него немножко написал вот тут: [[useReducer()]]. Переносим в него всё то, что раньше было в функциях *addPost* и *updateNewPostText*, а их удаляем из стора. 
4. Теперь метод *dispatch* выглядит вот так: ![[Pasted image 20221007181331.png]]
	Красным подчеркнул то, что раньше приходило в качестве параметров в функцию *updateNewPostText*, а теперь будет приходить из экшена. Но пока оно не приходит, из-за этого ошибка.
5. Так выглядит типизация: ![[Pasted image 20221007211501.png]]
6. Раньше в пропсах в *Арр* прокидывалась каждая функция по отдельности: ![[Pasted image 20221007211734.png]]
	Теперь же будет только одна: ![[Pasted image 20221007212120.png]]
7. Фиксим все выскакивающие ошибки из-за смены пропсов.
8. В компоненте *MyPosts* теперь вызываем *dispatch* вместо тех двух функций: ![[Pasted image 20221007213342.png]]
